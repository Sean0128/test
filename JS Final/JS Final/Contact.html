<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>JS Final</title>

  <!-- CSS  -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css" />	 
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/Additional.css" rel="stylesheet" type="text/css">

  <!--Built Scripts-->
  
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>  
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script> 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script>
  
  <!--Additional Scripts-->
  <script>
    function ad_js_a() {
      alert("將進入官方網站，非本專案之內容");
    }
  </script>

  <script type="text/javascript">

    function GoogleForm() {
  
      var field1 = $("[name='Name']").val();
      var field2 = $("[name='Comment']").val();
  
      $.ajax({
       
        url: "https://docs.google.com/forms/d/e/1FAIpQLSfLp8lDqaOzTuMYMPUr9l4P-_sYGsmJDA5hFniDCZU-8nB37g/formResponse", //Google Form 裡面的 
        data: {
        "entry.2110381021":field1,
        "entry.1942222886":field2
        },
  
        type: "POST",
        dataType: "xml",
       
        statusCode: {
        0: function() {
         alert("已送出!");//完成送出表單的警告視窗
         window.location.assign("Contact.html");//完成送出表單後的重新導向
        },
        200: function() {
         alert("已送出!");//完成送出表單的警告視窗
         window.location.assign("Contact.html");//完成送出表單後的重新導向
        }
       }
      });
     }
   
  </script>




  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>  
  
  
  <!-- 利用Google Visualization讀取Google Sheet https://www.labnol.org/code/google-sheet-d3js-visualization-200608 -->
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	
  <script>

    // https://developers.google.com/chart/interactive/docs/quick_start
    // Load the Visualization API and the corechart package.
    google.charts.load('current', {'packages':['corechart']});

    // Set a callback to run when the Google Visualization API is loaded.	
    google.charts.setOnLoadCallback(init);

    function init() {
        // 這個例子使用的試算表是 https://docs.google.com/spreadsheets/d/1QScI5d56Kh-LGywY4WR6EvRGPcalFQYUAdqMxbFVDvk/copy
        // 將上述試算表另存副本後，你要在自己的雲端硬碟將該試算表設定成[知道連結的使用者都能查看]。
        // 然後讓程式讀取 https://docs.google.com/spreadsheets/d/瀏覽器網址列上的網址擷取序號部分/gviz/tq?sheet=工作表名稱
        // 也就是將下列的 1QScI5d56Kh-LGywY4WR6EvRGPcalFQYUAdqMxbFVDvk 更換成自己的檔案序號，以及最後部分指讀取哪個工作表。
        var url =
        'https://docs.google.com/spreadsheets/d/1E5YSYx9zX78zIlAR_nrfbtafO-3UGmQ2aMlQORoGoI0/gviz/tq?sheet=Comments';
        var query = new google.visualization.Query(url);
        query.setQuery('select *');
        query.send(processSheetsData);
    }	

    function processSheetsData(response) {
        var data = response.getDataTable();
        var columns = data.getNumberOfColumns();
        var rows = data.getNumberOfRows();
        
        var s = "";
        for (r = rows - 1; r >= 0; r-- ){
            s = s + `<div class="card">
                        <div class="card-body" style='background-color:black; color:white' align="left">
                          ${data.getFormattedValue(r,0)} 『${data.getFormattedValue(r,1)}』 said: 
                        </div>
                        <div class="card-body" style='background-color:black; color:white' align="center">
                            「${data.getFormattedValue(r,2)}」
                        </div>
                    </div>`;
        }
    document.getElementById("demo").innerHTML = s;
    }
    </script>



  <!--End of Additional Scripts-->

</head>

<body style="background-color:black">  
  <!--Navigation and Side Navbars--> 
  <nav class="black" role="navigation">
    <div class="nav-wrapper container">
      <a id="logo-container" href="Main.html" class="brand-logo" style="font-family:'Papyrus'; font-weight:bold; color:white; font-size: medium">
        Sekiro:Shadow Die Twice
      </a>
      <ul class="right hide-on-med-and-down">
        <li><a href="NEWS.html" style="color:white; font-family:'Papyrus'; font-weight:bold">NEWS</a></li>
        <li><a href="Characters.html" style="color:white; font-family:'Papyrus'; font-weight:bold">Characters</a></li>
        <li><a href="Contact.html" style="color:white; font-family:'Papyrus'; font-weight:bold">Contact</a></li>
      </ul>

      <ul id="nav-mobile" class="sidenav" style="background-color: black;">
        <li><a href="NEWS.html" style="font-family:'Papyrus'; font-weight:bold; color:white">NEWS</a></li>
        <li><a href="Characters.html" style="font-family:'Papyrus'; font-weight:bold; color:white">Characters</a></li>
        <li><a href="Contact.html" style="font-family:'Papyrus'; font-weight:bold; color:white">Contact</a></li>
      </ul>
      <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons" style="color:white">menu</i></a>
    </div>
  </nav>
  <!--End of Navigations-->

  <!--Content 1-->
  <div class="container">
    <div class="section" style="padding:0px">
      <div class="row">
        <div id="demo" style="font-family:'Papyrus'; word-break: break-all;"></div>
      </div>
    </div>
  </div>
  <!--End of Content 1-->

  <!--Content 1-->
  <div class="container">
    <div class="section" style="padding:0px">
      <div class="row">
        <hr color="white">
        <h3 style="color:white; display:flex; justify-content:center; font-family:'Papyrus'">Leave Comments</h3>
        <form action="javascript:GoogleForm();">
          <fieldset style="width:300px">
            <legend style="color:white; font-family:'Papyrus'">Name</legend>
            <input type="text" name="Name" style="color:white">
          </fieldset>
          <fieldset>
            <legend style="color:white; font-family:'Papyrus'">Comments</legend>
            <input type="text" name="Comment" style="color:white">
          </fieldset>
          <br>
          <button type="submit">Submit</button>
        </form>
      </div>
    </div>
  </div>
  <!--End of Content 1-->
  
  <hr style="color:white">
  
  <!--Footer-->
  <footer class="page-footer teal" style="background-image:url('pictures/Black.png')">
    <div class="container">
      <div class="row">
        <div class="col l6 s12">
          <h5 class="white-text">Company Bio</h5>
          <p class="grey-text text-lighten-4">We are a team of college students working on this project like it's our full time job. Any amount would help support and continue development on this project and is greatly appreciated.</p>


        </div>
        <div class="col l3 s12">
          <h5 class="white-text">Settings</h5>
          <ul>
            <li><a class="white-text" href="#!">Link 1</a></li>
            <li><a class="white-text" href="#!">Link 2</a></li>
            <li><a class="white-text" href="#!">Link 3</a></li>
            <li><a class="white-text" href="#!">Link 4</a></li>
          </ul>
        </div>
        <div class="col l3 s12">
          <h5 class="white-text">Connect</h5>
          <ul>
            <li><a class="white-text" href="#!">Link 1</a></li>
            <li><a class="white-text" href="#!">Link 2</a></li>
            <li><a class="white-text" href="#!">Link 3</a></li>
            <li><a class="white-text" href="#!">Link 4</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
      Made by <a class="brown-text text-lighten-3" href="http://materializecss.com">Materialize</a>
      </div>
    </div>
  </footer>
  <!--End of footer-->
  </body>
</html>


